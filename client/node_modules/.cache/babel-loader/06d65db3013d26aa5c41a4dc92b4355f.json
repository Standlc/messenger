{"ast":null,"code":"var _jsxFileName = \"/Users/stan/Desktop/messenger/client/src/components/chat/messagesList/chatMessage/ChatMessage.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useRef, useState } from \"react\";\nimport { UserContext } from \"../../../../contexts/UserProvider\";\nimport { hasCloseNeighbor } from \"../isMessageClose\";\nimport \"./chatMessage.css\";\nimport ProfilePicture from \"../../../profilePicture/ProfilePicture\";\nimport ChatDate from \"./chatTime/ChatDate\";\nimport { DateTime } from \"luxon\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ChatMessage = _ref => {\n  _s();\n\n  let {\n    messages,\n    i\n  } = _ref;\n  const {\n    user\n  } = useContext(UserContext);\n  const messageRef = useRef(null);\n  const isOwnMessage = (user === null || user === void 0 ? void 0 : user._id) === messages[i].userInfos._id;\n  const [mouseOverTimeOut, setMouseOverTimeOut] = useState();\n  const [isMouseHovering, setIsMouseHovering] = useState(false); //HOVER MESSAGE\n\n  const handleMouseHoveringMessage = () => {\n    setMouseOverTimeOut(setTimeout(() => {\n      setIsMouseHovering(true);\n    }, 2000));\n  };\n\n  const handleMouseLeaving = () => {\n    if (mouseOverTimeOut) clearTimeout(mouseOverTimeOut);\n    setIsMouseHovering(false);\n  };\n\n  const hasNeighborBelow = hasCloseNeighbor({\n    order: \"next\",\n    messages,\n    i\n  });\n  const hasNeighborAbove = hasCloseNeighbor({\n    order: \"prev\",\n    messages,\n    i\n  });\n\n  const chatMessageClassName = () => {\n    if (isOwnMessage) {\n      if (hasNeighborBelow && hasNeighborAbove) return \"chat-message own-up-down\";else if (hasNeighborBelow && !hasNeighborAbove) return \"chat-message own-down\";else if (!hasNeighborBelow && hasNeighborAbove) return \"chat-message own-up\";else return \"chat-message own\";\n    } else {\n      if (hasNeighborBelow && hasNeighborAbove) return \"chat-message up-down\";else if (hasNeighborBelow && !hasNeighborAbove) return \"chat-message down\";else if (hasNeighborBelow && !hasNeighborAbove) return \"chat-message up\";else return \"chat-message\";\n    }\n  };\n\n  const messageTimeFormat = () => {\n    const today = DateTime.fromISO(new Date().toISOString()).toLocaleString();\n    const messageDate = DateTime.fromISO(messages[i].createdAt).toLocaleString();\n    const yearMonthDayHourMinute = DateTime.fromISO(messages[i].createdAt).toLocaleString({\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      hourCycle: \"h23\"\n    });\n    const dayHourMinute = DateTime.fromISO(messages[i].createdAt).toLocaleString({\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      hourCycle: \"h23\"\n    });\n\n    if (today !== messageDate) {\n      return yearMonthDayHourMinute;\n    } else {\n      return dayHourMinute;\n    }\n  }; // useEffect(() => {\n  //   scrollIntoView(messageRef);\n  // }, [messageRef]);\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: isOwnMessage ? \"chat-message-wrapper own\" : \"chat-message-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(ChatDate, {\n      messages: messages,\n      i: i\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-message-text-PP\",\n      children: [!hasNeighborBelow && !isOwnMessage && /*#__PURE__*/_jsxDEV(ProfilePicture, {\n        members: [messages[i].userInfos],\n        size: \"small\",\n        absolute: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }, this), isMouseHovering && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-message-date-info\",\n        children: messageTimeFormat()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        onMouseEnter: handleMouseHoveringMessage,\n        onMouseLeave: handleMouseLeaving,\n        ref: messageRef,\n        className: chatMessageClassName(),\n        children: messages[i].content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ChatMessage, \"J7OWLNczCzl6m7YAqhi54tvxih0=\");\n\n_c = ChatMessage;\nexport default ChatMessage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatMessage\");","map":{"version":3,"sources":["/Users/stan/Desktop/messenger/client/src/components/chat/messagesList/chatMessage/ChatMessage.tsx"],"names":["React","useContext","useRef","useState","UserContext","hasCloseNeighbor","ProfilePicture","ChatDate","DateTime","ChatMessage","messages","i","user","messageRef","isOwnMessage","_id","userInfos","mouseOverTimeOut","setMouseOverTimeOut","isMouseHovering","setIsMouseHovering","handleMouseHoveringMessage","setTimeout","handleMouseLeaving","clearTimeout","hasNeighborBelow","order","hasNeighborAbove","chatMessageClassName","messageTimeFormat","today","fromISO","Date","toISOString","toLocaleString","messageDate","createdAt","yearMonthDayHourMinute","month","day","hour","minute","hourCycle","dayHourMinute","content"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport { Message } from \"../../../../types\";\nimport { UserContext } from \"../../../../contexts/UserProvider\";\nimport { hasCloseNeighbor } from \"../isMessageClose\";\nimport \"./chatMessage.css\";\nimport { scrollIntoView } from \"./scrollIntoView\";\nimport ProfilePicture from \"../../../profilePicture/ProfilePicture\";\nimport ChatDate from \"./chatTime/ChatDate\";\nimport { DateTime } from \"luxon\";\n\nconst ChatMessage = ({ messages, i }: { messages: Message[]; i: number }) => {\n  const { user } = useContext(UserContext);\n  const messageRef = useRef<HTMLParagraphElement>(null);\n  const isOwnMessage = user?._id === messages[i].userInfos._id;\n  const [mouseOverTimeOut, setMouseOverTimeOut] = useState<NodeJS.Timeout>();\n  const [isMouseHovering, setIsMouseHovering] = useState(false);\n\n  //HOVER MESSAGE\n  const handleMouseHoveringMessage = () => {\n    setMouseOverTimeOut(\n      setTimeout(() => {\n        setIsMouseHovering(true);\n      }, 2000)\n    );\n  };\n\n  const handleMouseLeaving = () => {\n    if (mouseOverTimeOut) clearTimeout(mouseOverTimeOut);\n    setIsMouseHovering(false);\n  };\n\n  const hasNeighborBelow = hasCloseNeighbor({\n    order: \"next\",\n    messages,\n    i,\n  });\n  const hasNeighborAbove = hasCloseNeighbor({\n    order: \"prev\",\n    messages,\n    i,\n  });\n\n  const chatMessageClassName = () => {\n    if (isOwnMessage) {\n      if (hasNeighborBelow && hasNeighborAbove)\n        return \"chat-message own-up-down\";\n      else if (hasNeighborBelow && !hasNeighborAbove)\n        return \"chat-message own-down\";\n      else if (!hasNeighborBelow && hasNeighborAbove)\n        return \"chat-message own-up\";\n      else return \"chat-message own\";\n    } else {\n      if (hasNeighborBelow && hasNeighborAbove) return \"chat-message up-down\";\n      else if (hasNeighborBelow && !hasNeighborAbove)\n        return \"chat-message down\";\n      else if (hasNeighborBelow && !hasNeighborAbove) return \"chat-message up\";\n      else return \"chat-message\";\n    }\n  };\n\n  const messageTimeFormat = () => {\n    const today = DateTime.fromISO(new Date().toISOString()).toLocaleString();\n    const messageDate = DateTime.fromISO(\n      messages[i].createdAt\n    ).toLocaleString();\n\n    const yearMonthDayHourMinute = DateTime.fromISO(\n      messages[i].createdAt\n    ).toLocaleString({\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      hourCycle: \"h23\",\n    });\n    const dayHourMinute = DateTime.fromISO(\n      messages[i].createdAt\n    ).toLocaleString({\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      hourCycle: \"h23\",\n    });\n\n    if (today !== messageDate) {\n      return yearMonthDayHourMinute;\n    } else {\n      return dayHourMinute;\n    }\n  };\n\n  // useEffect(() => {\n  //   scrollIntoView(messageRef);\n  // }, [messageRef]);\n\n  return (\n    <div\n      className={\n        isOwnMessage ? \"chat-message-wrapper own\" : \"chat-message-wrapper\"\n      }\n    >\n      <ChatDate messages={messages} i={i} />\n      <div className=\"chat-message-text-PP\">\n        {!hasNeighborBelow && !isOwnMessage && (\n          <ProfilePicture\n            members={[messages[i].userInfos]}\n            size=\"small\"\n            absolute={true}\n          />\n        )}\n        {isMouseHovering && (\n          <div className={\"chat-message-date-info\"}>{messageTimeFormat()}</div>\n        )}\n        <p\n          onMouseEnter={handleMouseHoveringMessage}\n          onMouseLeave={handleMouseLeaving}\n          ref={messageRef}\n          className={chatMessageClassName()}\n        >\n          {messages[i].content}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatMessage;\n"]},"metadata":{},"sourceType":"module"}